name: Stale Issue Management

on:
  schedule:
    # Runs at 01:30 UTC daily
    - cron: '30 1 * * *'
  workflow_dispatch:  

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v10
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          
          # Timing
          days-before-stale: 60      # 60 days of inactivity -> stale
          days-before-close: 14      # +14 days -> auto-close
          
          # Labels
          stale-issue-label: 'stale'
          stale-pr-label: 'stale'
          
          # Exempt labels (never mark as stale)
          exempt-issue-labels: 'pinned,security,bug,enhancement,help wanted,good first issue'
          exempt-pr-labels: 'work-in-progress,blocked'
          
          # Messages
          stale-issue-message: |
            This issue has been automatically marked as stale because it has been inactive for over 60 days.
            
            **To keep it open:**
            - Add a comment with updates or context.
            - Remove the `stale` label.
            
            **If no activity occurs in the next 14 days, this issue will be closed.**
            
            If you believe this issue is still relevant, please let us know! We're happy to reopen it.
            
            Thanks for your contribution to miniAI!
          
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has been inactive for 45 days.
            
            **To keep it open:**
            - Rebase on the latest `main` branch.
            - Address any review comments.
            - Add a comment explaining the status.
            - Remove the `stale` label.
            
            **If no activity occurs in the next 14 days, this PR will be closed.**
            
            We appreciate your contribution! If you need help finishing this, let us know.
          
          close-issue-message: |
            This issue was automatically closed due to inactivity.
            
            If you believe this is still relevant, feel free to reopen it or create a new issue with updated context.
            
            Thank you for your understanding!
          
          close-pr-message: |
            This pull request was automatically closed due to inactivity.
            
            If you'd like to continue this work, please reopen the PR or submit a new one.
            
            We appreciate your contribution to miniAI!
          
          # Operations limits (avoid API rate limits)
          operations-per-run: 45
          
          # Delete branch after closing stale PR
          delete-branch: false
          
          # Enable debug output
          debug-only: false